/home/ymax29os/GANs/ams_project-2/transformer_GAN/transformer_model.py:94: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
/home/ymax29os/.local/lib/python3.9/site-packages/torch/amp/grad_scaler.py:132: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(
/home/ymax29os/GANs/ams_project-2/transformer_GAN/transformer_model.py:129: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
/home/ymax29os/.local/lib/python3.9/site-packages/torch/amp/autocast_mode.py:265: UserWarning: User provided device_type of 'cuda', but CUDA is not available. Disabling
  warnings.warn(
disc_real torch.Size([3200]) tensor([ 0.0589,  0.3279, -0.2453,  ..., -0.0706, -1.1613, -0.4275],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.3305,  0.2783, -0.0367,  ..., -0.0327, -1.5684, -0.1852],
       grad_fn=<ViewBackward0>)
/home/ymax29os/GANs/ams_project-2/transformer_GAN/transformer_model.py:154: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Discriminator output torch.Size([3200]) tensor([ 0.0034,  0.8290, -0.2814,  ..., -0.3008, -0.6751, -0.3701],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2465,  0.0274,  0.0436,  ...,  0.1915, -1.4644, -0.7620],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1833,  0.4289,  0.4840,  ...,  0.7101, -0.9124, -0.0779],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.0462,  0.0534,  0.5612,  ..., -0.4304, -0.8544, -0.5595],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4404, -0.8098,  1.0457,  ..., -0.3919, -0.5882,  0.0158],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([-0.2123,  0.3436,  0.6871,  ..., -0.1148, -0.4759, -0.5683],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.1829,  0.5545, -0.4070,  ..., -0.2067, -0.9268, -0.4209],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2008,  0.8938,  0.8215,  ..., -0.3326, -1.0806, -0.6831],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4588,  0.5958,  0.8681,  ..., -0.5756, -0.3813,  0.1367],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0977,  0.7755,  0.0826,  ...,  0.1633, -1.1188, -0.5661],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1525,  0.2183, -0.3021,  ..., -0.5387, -0.6125, -0.4700],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.0424,  0.6399,  0.4837,  ..., -0.0858, -0.5931, -0.4099],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 0.0129,  0.6705,  0.3910,  ...,  0.1922, -0.0131,  0.3595],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.5074,  0.3217,  0.7800,  ..., -0.0929, -1.0548,  0.1303],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7449,  0.3305,  0.4521,  ..., -0.1528, -0.6772,  0.2980],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1320,  0.4943,  0.3200,  ...,  0.3378, -0.3731, -0.2789],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1007,  0.4891,  0.3460,  ...,  0.1431, -0.8490,  0.4769],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7986,  0.6353, -0.2813,  ...,  0.4078, -0.4574, -0.4546],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1831, -0.0607,  0.6898,  ...,  0.0913, -1.5342, -0.2501],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([-0.1170,  0.0548,  0.3252,  ..., -0.1550, -0.6107,  0.0257],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.3942,  0.3452,  0.1568,  ..., -0.2267, -1.7085, -0.6217],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7625,  0.7963,  0.1050,  ...,  0.3852, -1.0422, -0.3262],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2494,  0.2918,  0.5131,  ...,  0.1271, -0.8941,  0.2882],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0437,  0.7515,  0.1484,  ..., -0.1862, -0.2854, -0.2071],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6693,  0.2468,  0.5293,  ...,  0.4346, -1.1481,  0.1426],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4877,  0.3383,  0.7667,  ...,  0.3172, -0.9715, -0.0249],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 0.4510,  0.1050,  0.4345,  ...,  0.2674, -0.1038, -0.4022],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 1.0149,  0.1679,  0.3283,  ..., -0.1575, -0.6698, -0.0663],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2734,  0.8245,  0.0090,  ..., -0.2941, -0.3370, -1.2124],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6727,  0.3957,  0.2713,  ...,  0.7895, -0.8844, -0.7271],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 1.0619,  0.9767, -0.2445,  ...,  0.1671, -0.3198, -0.2417],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.8904,  0.7484,  0.4037,  ...,  0.5370, -0.5137, -1.0213],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4828,  0.2880,  0.9719,  ..., -0.3956, -0.0018,  0.0837],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 0.7438,  0.6769,  0.9710,  ...,  0.3897, -0.3296, -0.1660],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.7700,  0.1692,  0.4632,  ...,  0.0834, -0.3675, -0.5365],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7007,  0.7094,  0.2287,  ...,  0.1413, -0.9711,  0.5110],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.8665,  0.5615,  1.0624,  ..., -0.4884, -1.3137, -0.2090],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6754,  0.2889,  0.5277,  ...,  0.4128, -0.7737, -0.2691],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0688,  0.0922,  0.4807,  ...,  0.3024, -0.6076, -0.3638],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.9461,  0.1551,  0.4774,  ..., -0.4969, -0.5373,  0.3783],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 0.8962,  0.3890,  0.0759,  ...,  0.6180, -0.4684,  0.6112],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([-0.3498,  0.4784,  0.5438,  ...,  0.1758, -0.6782, -0.0230],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7326,  0.3042,  0.0232,  ...,  0.0981, -0.4482, -0.1524],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0710, -0.1083,  0.2157,  ...,  0.2707, -0.9070,  0.3453],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.1315,  0.0462,  0.0759,  ..., -0.1519, -0.7226, -0.0641],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4879,  0.6199,  0.1684,  ...,  0.1235, -0.8894, -0.8121],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6974,  0.8387, -0.0626,  ..., -0.2369, -0.0830, -0.3510],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.0311,  0.7287,  1.0514,  ...,  0.3304, -0.6842,  0.6976],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.2113,  0.3301, -0.6975,  ..., -0.0966, -0.3691, -0.1387],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0726,  0.0951,  0.8689,  ...,  0.8094, -0.6063, -0.7344],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1750,  0.2241, -0.1112,  ..., -0.0187, -1.0334,  0.1103],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4412,  0.0171,  0.2403,  ..., -0.1124, -0.8112, -0.6575],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2784,  0.1968,  0.1335,  ...,  0.5926, -0.2139, -0.3196],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4563,  0.2370,  0.4332,  ...,  0.1265, -0.9658, -0.7992],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 0.8436,  0.6637,  0.7705,  ...,  0.4005, -0.7291,  0.1211],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.4473,  0.3543,  0.9478,  ...,  0.0774,  0.1174, -0.0229],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7449,  0.4104, -0.0018,  ...,  0.8237, -0.6092, -0.1995],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.9210,  0.5360, -0.1254,  ...,  0.9352, -0.7325, -0.6441],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3526,  0.3481, -0.3872,  ...,  0.9139, -0.7027,  0.0922],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.8424,  0.4333,  0.3739,  ...,  0.5042, -0.9964, -0.3499],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4759,  0.4025,  0.1147,  ...,  0.3102, -0.4918, -0.1025],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([0.8169, 0.7515, 0.7585,  ..., 0.7162, 0.1295, 0.4813],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.0121,  0.1146,  0.2198,  ..., -0.1139, -0.9046, -0.0942],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6577, -0.2408,  0.1687,  ...,  0.1910, -0.8373, -0.5690],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1061, -0.0215,  0.2484,  ...,  0.1537, -0.4984,  0.3424],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4559,  0.0652,  0.0071,  ...,  0.3212, -0.9050, -0.7638],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1884,  0.3089, -0.0178,  ...,  0.2572, -1.0853, -0.0421],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6094, -0.3227,  0.1628,  ...,  0.3842, -1.0297, -0.0785],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.3949,  0.9209,  1.3106,  ...,  0.4258, -0.5610, -0.0304],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 1.1146, -0.1140, -0.2654,  ..., -0.4439, -0.6729, -0.4370],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.8676,  0.3196,  0.0371,  ..., -0.2968, -0.3556, -0.6775],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4796,  0.4015,  0.1445,  ...,  0.5463, -0.8259, -0.9809],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6545,  0.5601, -0.3657,  ...,  0.5230, -0.2533, -0.9217],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6099,  0.0604, -0.1773,  ...,  0.1423, -1.5433, -0.3033],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4855,  0.0839, -0.3879,  ...,  0.4504, -0.6818,  0.2612],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 0.3647,  0.9537,  0.8557,  ...,  0.7151, -0.7430, -0.2856],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.7974, -0.0358, -0.3180,  ...,  0.6452, -0.5462, -0.3596],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.4655, -0.3922, -0.4078,  ...,  0.0956, -1.2024, -0.9998],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.3270, -0.3431,  0.3313,  ...,  0.1509,  0.2177, -0.6249],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.0970, -0.0852, -0.4570,  ...,  0.0765, -1.2037, -0.2116],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2240,  0.2004,  0.1153,  ...,  0.8389,  0.2697, -0.1833],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0577,  0.4844,  0.6128,  ..., -0.1460, -0.6867, -0.4338],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.4173,  0.9947,  1.2470,  ...,  1.1305, -0.5565,  0.6105],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([-0.0096,  0.2446,  0.7000,  ...,  0.1106, -0.3124, -0.7862],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1421, -0.9322,  0.2936,  ...,  0.7387, -1.0536, -0.9121],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.5698,  0.1852, -0.1478,  ..., -0.0251, -1.0725, -0.4213],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.3391, -0.3991,  0.0623,  ...,  0.2968, -1.0430, -1.0470],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3248,  0.2428, -0.2810,  ..., -0.0753, -0.5602, -0.9513],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6690, -0.9805, -0.0377,  ...,  0.2132, -0.9359, -0.3261],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([0.9078, 0.9083, 0.9712,  ..., 0.9706, 0.2371, 0.0892],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.2818, -0.5565,  0.5889,  ...,  0.4077, -0.8527, -0.8059],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7527, -0.4366, -0.7325,  ...,  0.2390, -1.0977, -0.4380],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0276, -0.2163,  0.5412,  ...,  0.3201, -1.0641,  0.0043],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0593, -0.3240, -0.3536,  ...,  0.0056, -1.1514, -0.8587],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0367, -0.1531,  0.2659,  ...,  0.1667, -0.8541, -0.7926],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3591, -0.1867, -0.2667,  ..., -0.5166, -1.4660, -0.5622],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.5130,  0.5107,  1.2150,  ...,  0.7430, -0.3434,  0.1485],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.6399, -0.3434, -0.9496,  ..., -0.0461, -0.5270, -0.8573],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7424, -0.0166, -0.3197,  ...,  0.2996, -1.4605, -1.0431],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.0123, -0.7751, -0.4990,  ..., -0.2299, -0.4877, -0.3928],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3378, -0.0328, -0.1082,  ..., -0.1305, -1.0697, -0.5331],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4516, -0.7617,  0.2795,  ..., -0.1753, -0.0403, -0.0238],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.8059, -0.1133, -1.1847,  ..., -0.2436, -1.4951, -1.1942],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.0619,  0.7605,  1.1709,  ...,  0.7342,  0.5840, -0.6042],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([-0.2065, -0.5260,  0.2588,  ...,  0.5990, -0.3694, -1.2483],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1757, -0.5558, -0.7360,  ..., -0.1265, -0.5893, -0.7544],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0435, -0.4968, -0.4270,  ..., -0.3312, -1.3410, -1.2093],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1781, -0.3196,  0.1432,  ..., -0.1213, -1.2692, -1.4561],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0267, -0.3130, -0.6199,  ..., -0.6884, -0.6833, -1.0819],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3813, -0.6254, -1.0431,  ..., -0.2335, -0.7106, -1.2863],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([1.7817, 0.8107, 1.0944,  ..., 1.8947, 0.1094, 0.0928],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.3798, -0.5230, -0.6621,  ...,  0.8591, -1.1972, -0.9249],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.4119, -0.9772, -0.3813,  ...,  0.1196, -0.7791, -0.9291],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-1.9981e-02, -4.9060e-01, -2.9572e-01,  ...,  2.9802e-04,
        -1.3526e+00, -9.6634e-01], grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2748, -0.6536, -0.6407,  ...,  0.0263, -0.5038, -0.7158],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4174, -1.1021, -0.8252,  ...,  0.1122, -0.8346, -0.7237],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3270, -0.8443, -0.5705,  ..., -0.1107, -0.8284, -1.2079],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([1.2885, 1.4054, 1.2432,  ..., 0.7053, 1.0714, 0.1596],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.6984, -0.5994, -0.5012,  ..., -0.3600, -1.0162, -0.9775],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3350, -0.2347, -0.5855,  ..., -1.0796, -1.1679, -0.6283],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.0591, -1.2104, -0.6851,  ..., -0.3401, -1.6832, -1.5734],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.1375, -0.1703, -0.6953,  ..., -0.8037, -0.1307, -1.2066],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.5091, -0.8533, -0.7532,  ..., -0.5728, -1.1566, -0.5323],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.5383, -0.9673, -0.7760,  ...,  0.0828, -1.6765, -0.6736],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.4657,  0.8516,  1.2815,  ...,  0.5383, -0.9279, -0.4865],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([-0.0176, -0.2259, -0.4623,  ..., -0.0482, -0.1207, -0.2555],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0900, -0.4430, -0.1921,  ...,  0.4571, -1.6334, -1.1876],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3627, -0.6627, -1.0196,  ..., -0.4292, -1.1012, -1.1239],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3574, -0.4629, -0.1979,  ..., -0.0316, -1.8229, -1.6556],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3942, -0.5248, -1.0162,  ..., -0.7554, -1.0562, -1.2418],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3267, -0.0945, -0.5813,  ...,  0.0114, -1.5137, -0.3783],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([1.5924, 1.0047, 1.8820,  ..., 1.2065, 0.0269, 0.3288],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.1706, -0.8675, -0.0790,  ..., -0.3072, -0.9807, -1.8556],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0570, -1.0201, -0.5742,  ..., -0.7815, -1.1000, -0.2726],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6872, -0.6736, -0.6018,  ..., -0.8679, -1.0018, -1.1801],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0732, -1.0662,  0.2751,  ..., -1.0203, -1.4152, -0.9158],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4491, -0.5349,  0.6970,  ..., -0.3383, -1.5075, -1.2044],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.2041, -0.5310, -0.8468,  ..., -0.3614, -0.6352, -1.2212],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.5896,  0.0441,  1.9543,  ...,  1.2033, -0.0874,  0.2804],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.2542, -0.7577, -0.2467,  ..., -0.4046, -1.5175, -1.5206],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.3127, -1.0986, -0.8908,  ..., -0.1366, -1.2235, -1.7036],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.6180, -0.8468, -1.2573,  ...,  0.0229, -1.3982, -1.0457],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4882, -0.5923, -1.4960,  ..., -0.4102, -2.1228, -1.4927],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4908, -0.8429, -1.1506,  ..., -0.0210, -1.3195, -1.7353],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.0413, -0.6180, -0.4514,  ...,  0.9173, -1.2188, -1.0225],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 2.3156,  1.1778,  0.9821,  ...,  0.8195, -0.0671,  0.1496],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.4755, -1.6634,  0.3624,  ..., -0.3200, -1.4523, -1.6618],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3653, -0.8970, -0.2347,  ..., -1.1597, -2.0794, -2.1195],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4068, -1.5278, -0.5565,  ..., -0.7355, -0.7999, -1.5489],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.9032, -1.0057, -0.0856,  ..., -0.7963, -1.1877, -0.9504],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.8424, -1.4195, -0.2787,  ..., -1.1491, -1.0085, -1.8141],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.3059, -1.0337, -1.3863,  ..., -0.1838, -1.6796, -1.4820],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 2.1771,  0.9865,  1.7094,  ...,  1.5389,  0.2569, -0.4626],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([-0.0269, -1.1333, -0.1443,  ..., -0.0325, -1.0676, -1.7782],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1628, -0.8010, -1.0408,  ..., -0.5700, -1.0364, -1.2050],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4774, -1.1025, -0.8717,  ..., -0.7334, -0.8572, -1.3681],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.5059, -1.2224, -0.9318,  ..., -1.1407, -1.6397, -1.6347],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.7438, -1.6945, -1.2262,  ..., -0.9757, -1.1400, -2.0992],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.2087, -1.0293, -0.9882,  ..., -0.9731, -0.7142, -1.9230],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([ 1.5195,  1.0013,  1.0634,  ...,  1.4457,  0.3234, -0.0020],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 0.5434, -1.2533, -1.0283,  ..., -0.1646, -1.0787, -1.4927],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.4388, -1.4670, -1.1250,  ..., -1.5010, -1.7300, -1.6537],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.1163, -1.3904, -1.4854,  ..., -0.6236, -1.1401, -1.0977],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.2810, -1.2268, -1.6288,  ..., -0.3893, -1.2015, -1.6667],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 1.1898, -1.0080, -1.2749,  ..., -0.7796, -1.0813, -1.8014],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([-0.0030, -1.4260, -1.7086,  ..., -0.5466, -1.2432, -1.8311],
       grad_fn=<ViewBackward0>)
disc_real torch.Size([3200]) tensor([1.4370, 1.1203, 1.4719,  ..., 0.7822, 0.1015, 0.6996],
       grad_fn=<ViewBackward0>)
disc_fake torch.Size([3200]) tensor([ 1.0146, -0.4981, -1.1461,  ..., -0.7447, -1.3330, -1.7395],
       grad_fn=<ViewBackward0>)
Discriminator output torch.Size([3200]) tensor([ 0.1879, -0.8986, -1.3312,  ..., -1.4719, -1.2307, -1.6887],
       grad_fn=<ViewBackward0>)
Traceback (most recent call last):
  File "/home/ymax29os/GANs/ams_project-2/transformer_GAN/main.py", line 52, in <module>
    generator = train_transformer_model(
  File "/home/ymax29os/GANs/ams_project-2/transformer_GAN/transformer_model.py", line 156, in train_transformer_model
    output = discriminator(fake_data.detach()).view(-1)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ymax29os/GANs/ams_project-2/transformer_GAN/transformer_model.py", line 81, in forward
    out = layer(out, out, out)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ymax29os/GANs/ams_project-2/transformer_GAN/transformer_model.py", line 23, in forward
    attention = self.attention(query, key, value)[0]
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 1275, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/functional.py", line 5526, in multi_head_attention_forward
    attn_output_weights = softmax(attn_output_weights, dim=-1)
  File "/home/ymax29os/.local/lib/python3.9/site-packages/torch/nn/functional.py", line 1888, in softmax
    ret = input.softmax(dim)
KeyboardInterrupt
